import { remote, ipcRenderer } from 'electron';
import { clipboard } from 'electron';
import React, { useState } from 'react';
import { H4, Card, Label, InputGroup, FormGroup, Callout, Button } from '@blueprintjs/core';
import { useSetting } from '../../settings/renderer';
import styles from './data-synchronizer.scss';
export const DataSynchronizer = function ({ upstreamURL, inPreLaunchSetup }) {
    const [loading, setLoading] = useState(false);
    const url = useSetting('gitRepoUrl', '');
    const name = useSetting('gitAuthorName', '');
    const email = useSetting('gitAuthorEmail', '');
    const username = useSetting('gitUsername', '');
    const usingUpstream = url.value && url.value.trim() === upstreamURL.trim();
    let urlIsValid;
    try {
        if (url.value) {
            new URL(url.value.trim());
            urlIsValid = true;
        }
        else {
            urlIsValid = false;
        }
    }
    catch (e) {
        urlIsValid = false;
    }
    const complete = (urlIsValid &&
        name.value && name.value.trim() != '' &&
        email.value && email.value.trim() != '' &&
        username.value && username.value.trim() != '');
    async function handleSaveAndClose() {
        setLoading(true);
        await name.commit();
        await email.commit();
        await username.commit();
        // In pre launch we can modify URL, but updating Git config requires waiting for the app to load,
        // initializing the repo
        if (inPreLaunchSetup) {
            await url.commit();
        }
        setTimeout(() => {
            remote.getCurrentWindow().close();
        }, 2000);
    }
    async function handleResetURL() {
        await ipcRenderer.send('clear-setting', 'gitRepoUrl');
        remote.app.relaunch();
        remote.app.exit(0);
    }
    async function copyUpstreamRepoURL() {
        clipboard.writeText(upstreamURL);
    }
    return (React.createElement("div", { className: styles.dataSyncBase },
        React.createElement(Card, { key: "repoUrl", className: styles.repoUrlCard },
            React.createElement(FormGroup, { label: "Repository URL", intent: inPreLaunchSetup && !urlIsValid ? "danger" : undefined, helperText: inPreLaunchSetup
                    ? React.createElement(Callout, { intent: "primary" },
                        React.createElement("p", null, "Please enter a valid URL of the repository you have commit access to, and which is a fork of the upstream repository."),
                        React.createElement("p", null,
                            React.createElement(Button, { onClick: copyUpstreamRepoURL }, "Copy upstream repository URL")))
                    : React.createElement(Callout, { intent: "warning" }, "Note: resetting the URL will cause you to lose any unsubmitted changes.") },
                React.createElement(InputGroup, { value: url.value, placeholder: upstreamURL, disabled: inPreLaunchSetup !== true, type: "text", onChange: inPreLaunchSetup
                        ? (evt) => {
                            url.set(evt.target.value);
                        }
                        : undefined, rightElement: inPreLaunchSetup
                        ? undefined
                        : React.createElement(Button, { intent: "danger", minimal: true, title: "Reset repository URL. Note: you will lose any unsubmitted changes.", onClick: handleResetURL }, "Reset URL") }))),
        React.createElement(Card, { key: "committerInfo", className: styles.committerInfoCard },
            React.createElement(H4, null, "Committing changes as"),
            React.createElement("div", { className: styles.dataSyncRow },
                React.createElement(Label, { key: "authorName" },
                    "Author name",
                    React.createElement(InputGroup, { value: name.value, type: "text", onChange: (evt) => {
                            name.set(evt.target.value);
                        } })),
                React.createElement(Label, { key: "authorEmail" },
                    "Author email",
                    React.createElement(InputGroup, { value: email.value, type: "email", onChange: (evt) => {
                            email.set(evt.target.value);
                        } })),
                React.createElement(Label, { key: "username" },
                    "Username",
                    React.createElement(InputGroup, { value: username.value, type: "text", onChange: (evt) => {
                            username.set(evt.target.value);
                        } })))),
        React.createElement("footer", { key: "actionRow", className: styles.windowAction },
            React.createElement(Button, { className: "confirm-button", key: "confirm", large: true, fill: true, intent: !usingUpstream ? "primary" : "warning", loading: loading === true, disabled: complete !== true, onClick: handleSaveAndClose }, inPreLaunchSetup
                ? React.createElement(React.Fragment, null,
                    "Save settings using ",
                    usingUpstream ? "upstream" : "fork",
                    " repository and launch")
                : React.createElement(React.Fragment, null, "Save and close")))));
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0YS1zeW5jaHJvbml6ZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvc3RvcmFnZS9yZW5kZXJlci9kYXRhLXN5bmNocm9uaXplci50c3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLE1BQU0sRUFBRSxXQUFXLEVBQUUsTUFBTSxVQUFVLENBQUM7QUFDL0MsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLFVBQVUsQ0FBQztBQUVyQyxPQUFPLEtBQUssRUFBRSxFQUFFLFFBQVEsRUFBRSxNQUFNLE9BQU8sQ0FBQztBQUN4QyxPQUFPLEVBQUUsRUFBRSxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsVUFBVSxFQUFFLFNBQVMsRUFBRSxPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFFNUYsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLHlCQUF5QixDQUFDO0FBRXJELE9BQU8sTUFBTSxNQUFNLDBCQUEwQixDQUFDO0FBTzlDLE1BQU0sQ0FBQyxNQUFNLGdCQUFnQixHQUFvQyxVQUFVLEVBQUUsV0FBVyxFQUFFLGdCQUFnQixFQUFFO0lBQzFHLE1BQU0sQ0FBQyxPQUFPLEVBQUUsVUFBVSxDQUFDLEdBQUcsUUFBUSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBRTlDLE1BQU0sR0FBRyxHQUFHLFVBQVUsQ0FBUyxZQUFZLEVBQUUsRUFBRSxDQUFDLENBQUM7SUFDakQsTUFBTSxJQUFJLEdBQUcsVUFBVSxDQUFTLGVBQWUsRUFBRSxFQUFFLENBQUMsQ0FBQztJQUNyRCxNQUFNLEtBQUssR0FBRyxVQUFVLENBQVMsZ0JBQWdCLEVBQUUsRUFBRSxDQUFDLENBQUM7SUFDdkQsTUFBTSxRQUFRLEdBQUcsVUFBVSxDQUFTLGFBQWEsRUFBRSxFQUFFLENBQUMsQ0FBQztJQUV2RCxNQUFNLGFBQWEsR0FBRyxHQUFHLENBQUMsS0FBSyxJQUFJLEdBQUcsQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFLEtB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QUFDLE1BQU0sRUFDWCxRQUFRLEVBQUUsQ0FBQyxHQUFpQyxFQUFFLEVBQUU7NEJBQzlDLFFBQVEsQ0FBQyxHQUFHLENBQUUsR0FBRyxDQUFDLE1BQTJCLENBQUMsS0FBZSxDQUFDLENBQUM7d0JBQ2pFLENBQUMsR0FDRCxDQUNJLENBQ0osQ0FDRDtRQUVQLGdDQUFRLEdBQUcsRUFBQyxXQUFXLEVBQUMsU0FBUyxFQUFFLE1BQU0sQ0FBQyxZQUFZO1lBQ3BELG9CQUFDLE1BQU0sSUFDSCxTQUFTLEVBQUMsZ0JBQWdCLEVBQzFCLEdBQUcsRUFBQyxTQUFTLEVBQ2IsS0FBSyxFQUFFLElBQUksRUFDWCxJQUFJLEVBQUUsSUFBSSxFQUNWLE1BQU0sRUFBRSxDQUFDLGFBQWEsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxTQUFTLEVBQzlDLE9BQU8sRUFBRSxPQUFPLEtBQUssSUFBSSxFQUN6QixRQUFRLEVBQUUsUUFBUSxLQUFLLElBQUksRUFDM0IsT0FBTyxFQUFFLGtCQUFrQixJQUM1QixnQkFBZ0I7Z0JBQ2YsQ0FBQyxDQUFDOztvQkFBdUIsYUFBYSxDQUFDLENBQUMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLE1BQU07NkNBQTBCO2dCQUN0RixDQUFDLENBQUMsMkRBQW1CLENBQ2hCLENBQ0YsQ0FDTCxDQUNQLENBQUM7QUFDSixDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyByZW1vdGUsIGlwY1JlbmRlcmVyIH0gZnJvbSAnZWxlY3Ryb24nO1xuaW1wb3J0IHsgY2xpcGJvYXJkIH0gZnJvbSAnZWxlY3Ryb24nO1xuXG5pbXBvcnQgUmVhY3QsIHsgdXNlU3RhdGUgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBINCwgQ2FyZCwgTGFiZWwsIElucHV0R3JvdXAsIEZvcm1Hcm91cCwgQ2FsbG91dCwgQnV0dG9uIH0gZnJvbSAnQGJsdWVwcmludGpzL2NvcmUnO1xuXG5pbXBvcnQgeyB1c2VTZXR0aW5nIH0gZnJvbSAnLi4vLi4vc2V0dGluZ3MvcmVuZGVyZXInO1xuXG5pbXBvcnQgc3R5bGVzIGZyb20gJy4vZGF0YS1zeW5jaHJvbml6ZXIuc2Nzcyc7XG5cblxuaW50ZXJmYWNlIERhdGFTeW5jaHJvbml6ZXJQcm9wcyB7XG4gIHVwc3RyZWFtVVJMOiBzdHJpbmcsXG4gIGluUHJlTGF1bmNoU2V0dXA6IGJvb2xlYW4sXG59XG5leHBvcnQgY29uc3QgRGF0YVN5bmNocm9uaXplcjogUmVhY3QuRkM8RGF0YVN5bmNocm9uaXplclByb3BzPiA9IGZ1bmN0aW9uICh7IHVwc3RyZWFtVVJMLCBpblByZUxhdW5jaFNldHVwIH0pIHtcbiAgY29uc3QgW2xvYWRpbmcsIHNldExvYWRpbmddID0gdXNlU3RhdGUoZmFsc2UpO1xuXG4gIGNvbnN0IHVybCA9IHVzZVNldHRpbmc8c3RyaW5nPignZ2l0UmVwb1VybCcsICcnKTtcbiAgY29uc3QgbmFtZSA9IHVzZVNldHRpbmc8c3RyaW5nPignZ2l0QXV0aG9yTmFtZScsICcnKTtcbiAgY29uc3QgZW1haWwgPSB1c2VTZXR0aW5nPHN0cmluZz4oJ2dpdEF1dGhvckVtYWlsJywgJycpO1xuICBjb25zdCB1c2VybmFtZSA9IHVzZVNldHRpbmc8c3RyaW5nPignZ2l0VXNlcm5hbWUnLCAnJyk7XG5cbiAgY29uc3QgdXNpbmdVcHN0cmVhbSA9IHVybC52YWx1ZSAmJiB1cmwudmFsdWUudHJpbSgpID09PSB1cHN0cmVhbVVSTC50cmltKCk7XG4gIGxldCB1cmxJc1ZhbGlkOiBib29sZWFuO1xuICB0cnkge1xuICAgIGlmICh1cmwudmFsdWUpIHtcbiAgICAgIG5ldyBVUkwodXJsLnZhbHVlLnRyaW0oKSk7XG4gICAgICB1cmxJc1ZhbGlkID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdXJsSXNWYWxpZCA9IGZhbHNlO1xuICAgIH1cbiAgfSBjYXRjaCAoZSkge1xuICAgIHVybElzVmFsaWQgPSBmYWxzZTtcbiAgfVxuXG4gIGNvbnN0IGNvbXBsZXRlID0gKFxuICAgIHVybElzVmFsaWQgJiZcbiAgICBuYW1lLnZhbHVlICYmIG5hbWUudmFsdWUudHJpbSgpICE9ICcnICYmXG4gICAgZW1haWwudmFsdWUgJiYgZW1haWwudmFsdWUudHJpbSgpICE9ICcnICYmXG4gICAgdXNlcm5hbWUudmFsdWUgJiYgdXNlcm5hbWUudmFsdWUudHJpbSgpICE9ICcnKTtcblxuICBhc3luYyBmdW5jdGlvbiBoYW5kbGVTYXZlQW5kQ2xvc2UoKSB7XG4gICAgc2V0TG9hZGluZyh0cnVlKTtcblxuICAgIGF3YWl0IG5hbWUuY29tbWl0KCk7XG4gICAgYXdhaXQgZW1haWwuY29tbWl0KCk7XG4gICAgYXdhaXQgdXNlcm5hbWUuY29tbWl0KCk7XG5cbiAgICAvLyBJbiBwcmUgbGF1bmNoIHdlIGNhbiBtb2RpZnkgVVJMLCBidXQgdXBkYXRpbmcgR2l0IGNvbmZpZyByZXF1aXJlcyB3YWl0aW5nIGZvciB0aGUgYXBwIHRvIGxvYWQsXG4gICAgLy8gaW5pdGlhbGl6aW5nIHRoZSByZXBvXG4gICAgaWYgKGluUHJlTGF1bmNoU2V0dXApIHtcbiAgICAgIGF3YWl0IHVybC5jb21taXQoKTtcbiAgICB9XG5cbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIHJlbW90ZS5nZXRDdXJyZW50V2luZG93KCkuY2xvc2UoKTtcbiAgICB9LCAyMDAwKTtcbiAgfVxuXG4gIGFzeW5jIGZ1bmN0aW9uIGhhbmRsZVJlc2V0VVJMKCkge1xuICAgIGF3YWl0IGlwY1JlbmRlcmVyLnNlbmQoJ2NsZWFyLXNldHRpbmcnLCAnZ2l0UmVwb1VybCcpO1xuICAgIHJlbW90ZS5hcHAucmVsYXVuY2goKTtcbiAgICByZW1vdGUuYXBwLmV4aXQoMCk7XG4gIH1cblxuICBhc3luYyBmdW5jdGlvbiBjb3B5VXBzdHJlYW1SZXBvVVJMKCkge1xuICAgIGNsaXBib2FyZC53cml0ZVRleHQodXBzdHJlYW1VUkwpO1xuICB9XG5cbiAgcmV0dXJuIChcbiAgICA8ZGl2IGNsYXNzTmFtZT17c3R5bGVzLmRhdGFTeW5jQmFzZX0+XG4gICAgICA8Q2FyZCBrZXk9XCJyZXBvVXJsXCIgY2xhc3NOYW1lPXtzdHlsZXMucmVwb1VybENhcmR9PlxuICAgICAgICA8Rm9ybUdyb3VwXG4gICAgICAgICAgICBsYWJlbD1cIlJlcG9zaXRvcnkgVVJMXCJcbiAgICAgICAgICAgIGludGVudD17aW5QcmVMYXVuY2hTZXR1cCAmJiAhdXJsSXNWYWxpZCA/IFwiZGFuZ2VyXCIgOiB1bmRlZmluZWR9XG4gICAgICAgICAgICBoZWxwZXJUZXh0PXtpblByZUxhdW5jaFNldHVwXG4gICAgICAgICAgICAgID8gPENhbGxvdXQgaW50ZW50PVwicHJpbWFyeVwiPlxuICAgICAgICAgICAgICAgICAgPHA+XG4gICAgICAgICAgICAgICAgICAgIFBsZWFzZSBlbnRlciBhIHZhbGlkIFVSTCBvZiB0aGUgcmVwb3NpdG9yeSB5b3UgaGF2ZSBjb21taXQgYWNjZXNzIHRvLFxuICAgICAgICAgICAgICAgICAgICBhbmQgd2hpY2ggaXMgYSBmb3JrIG9mIHRoZSB1cHN0cmVhbSByZXBvc2l0b3J5LlxuICAgICAgICAgICAgICAgICAgPC9wPlxuICAgICAgICAgICAgICAgICAgPHA+XG4gICAgICAgICAgICAgICAgICAgIDxCdXR0b24gb25DbGljaz17Y29weVVwc3RyZWFtUmVwb1VSTH0+Q29weSB1cHN0cmVhbSByZXBvc2l0b3J5IFVSTDwvQnV0dG9uPlxuICAgICAgICAgICAgICAgICAgPC9wPlxuICAgICAgICAgICAgICAgIDwvQ2FsbG91dD5cbiAgICAgICAgICAgICAgOiA8Q2FsbG91dCBpbnRlbnQ9XCJ3YXJuaW5nXCI+XG4gICAgICAgICAgICAgICAgICBOb3RlOiByZXNldHRpbmcgdGhlIFVSTCB3aWxsIGNhdXNlIHlvdSB0byBsb3NlIGFueSB1bnN1Ym1pdHRlZCBjaGFuZ2VzLlxuICAgICAgICAgICAgICAgIDwvQ2FsbG91dD59PlxuICAgICAgICAgIDxJbnB1dEdyb3VwXG4gICAgICAgICAgICB2YWx1ZT17dXJsLnZhbHVlfVxuICAgICAgICAgICAgcGxhY2Vob2xkZXI9e3Vwc3RyZWFtVVJMfVxuICAgICAgICAgICAgZGlzYWJsZWQ9e2luUHJlTGF1bmNoU2V0dXAgIT09IHRydWV9XG4gICAgICAgICAgICB0eXBlPVwidGV4dFwiXG4gICAgICAgICAgICBvbkNoYW5nZT17aW5QcmVMYXVuY2hTZXR1cFxuICAgICAgICAgICAgICA/IChldnQ6IFJlYWN0LkZvcm1FdmVudDxIVE1MRWxlbWVudD4pID0+IHtcbiAgICAgICAgICAgICAgICB1cmwuc2V0KChldnQudGFyZ2V0IGFzIEhUTUxJbnB1dEVsZW1lbnQpLnZhbHVlIGFzIHN0cmluZyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgOiB1bmRlZmluZWR9XG4gICAgICAgICAgICByaWdodEVsZW1lbnQ9e2luUHJlTGF1bmNoU2V0dXBcbiAgICAgICAgICAgICAgPyB1bmRlZmluZWRcbiAgICAgICAgICAgICAgOiA8QnV0dG9uXG4gICAgICAgICAgICAgICAgICAgIGludGVudD1cImRhbmdlclwiXG4gICAgICAgICAgICAgICAgICAgIG1pbmltYWw9e3RydWV9XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlPVwiUmVzZXQgcmVwb3NpdG9yeSBVUkwuIE5vdGU6IHlvdSB3aWxsIGxvc2UgYW55IHVuc3VibWl0dGVkIGNoYW5nZXMuXCJcbiAgICAgICAgICAgICAgICAgICAgb25DbGljaz17aGFuZGxlUmVzZXRVUkx9PlxuICAgICAgICAgICAgICAgICAgUmVzZXQgVVJMXG4gICAgICAgICAgICAgICAgPC9CdXR0b24+fVxuICAgICAgICAgIC8+XG4gICAgICAgIDwvRm9ybUdyb3VwPlxuICAgICAgPC9DYXJkPlxuXG4gICAgICA8Q2FyZCBrZXk9XCJjb21taXR0ZXJJbmZvXCIgY2xhc3NOYW1lPXtzdHlsZXMuY29tbWl0dGVySW5mb0NhcmR9PlxuICAgICAgICA8SDQ+Q29tbWl0dGluZyBjaGFuZ2VzIGFzPC9IND5cblxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT17c3R5bGVzLmRhdGFTeW5jUm93fT5cbiAgICAgICAgICA8TGFiZWwga2V5PVwiYXV0aG9yTmFtZVwiPlxuICAgICAgICAgICAgQXV0aG9yIG5hbWVcbiAgICAgICAgICAgIDxJbnB1dEdyb3VwXG4gICAgICAgICAgICAgIHZhbHVlPXtuYW1lLnZhbHVlfVxuICAgICAgICAgICAgICB0eXBlPVwidGV4dFwiXG4gICAgICAgICAgICAgIG9uQ2hhbmdlPXsoZXZ0OiBSZWFjdC5Gb3JtRXZlbnQ8SFRNTEVsZW1lbnQ+KSA9PiB7XG4gICAgICAgICAgICAgICAgbmFtZS5zZXQoKGV2dC50YXJnZXQgYXMgSFRNTElucHV0RWxlbWVudCkudmFsdWUgYXMgc3RyaW5nKTtcbiAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgPC9MYWJlbD5cblxuICAgICAgICAgIDxMYWJlbCBrZXk9XCJhdXRob3JFbWFpbFwiPlxuICAgICAgICAgICAgQXV0aG9yIGVtYWlsXG4gICAgICAgICAgICA8SW5wdXRHcm91cFxuICAgICAgICAgICAgICB2YWx1ZT17ZW1haWwudmFsdWV9XG4gICAgICAgICAgICAgIHR5cGU9XCJlbWFpbFwiXG4gICAgICAgICAgICAgIG9uQ2hhbmdlPXsoZXZ0OiBSZWFjdC5Gb3JtRXZlbnQ8SFRNTEVsZW1lbnQ+KSA9PiB7XG4gICAgICAgICAgICAgICAgZW1haWwuc2V0KChldnQudGFyZ2V0IGFzIEhUTUxJbnB1dEVsZW1lbnQpLnZhbHVlIGFzIHN0cmluZyk7XG4gICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAvPlxuICAgICAgICAgIDwvTGFiZWw+XG5cbiAgICAgICAgICA8TGFiZWwga2V5PVwidXNlcm5hbWVcIj5cbiAgICAgICAgICAgIFVzZXJuYW1lXG4gICAgICAgICAgICA8SW5wdXRHcm91cFxuICAgICAgICAgICAgICB2YWx1ZT17dXNlcm5hbWUudmFsdWV9XG4gICAgICAgICAgICAgIHR5cGU9XCJ0ZXh0XCJcbiAgICAgICAgICAgICAgb25DaGFuZ2U9eyhldnQ6IFJlYWN0LkZvcm1FdmVudDxIVE1MRWxlbWVudD4pID0+IHtcbiAgICAgICAgICAgICAgICB1c2VybmFtZS5zZXQoKGV2dC50YXJnZXQgYXMgSFRNTElucHV0RWxlbWVudCkudmFsdWUgYXMgc3RyaW5nKTtcbiAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgPC9MYWJlbD5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L0NhcmQ+XG5cbiAgICAgIDxmb290ZXIga2V5PVwiYWN0aW9uUm93XCIgY2xhc3NOYW1lPXtzdHlsZXMud2luZG93QWN0aW9ufT5cbiAgICAgICAgPEJ1dHRvblxuICAgICAgICAgICAgY2xhc3NOYW1lPVwiY29uZmlybS1idXR0b25cIlxuICAgICAgICAgICAga2V5PVwiY29uZmlybVwiXG4gICAgICAgICAgICBsYXJnZT17dHJ1ZX1cbiAgICAgICAgICAgIGZpbGw9e3RydWV9XG4gICAgICAgICAgICBpbnRlbnQ9eyF1c2luZ1Vwc3RyZWFtID8gXCJwcmltYXJ5XCIgOiBcIndhcm5pbmdcIn1cbiAgICAgICAgICAgIGxvYWRpbmc9e2xvYWRpbmcgPT09IHRydWV9XG4gICAgICAgICAgICBkaXNhYmxlZD17Y29tcGxldGUgIT09IHRydWV9XG4gICAgICAgICAgICBvbkNsaWNrPXtoYW5kbGVTYXZlQW5kQ2xvc2V9PlxuICAgICAgICAgIHtpblByZUxhdW5jaFNldHVwXG4gICAgICAgICAgICA/IDw+U2F2ZSBzZXR0aW5ncyB1c2luZyB7dXNpbmdVcHN0cmVhbSA/IFwidXBzdHJlYW1cIiA6IFwiZm9ya1wifSByZXBvc2l0b3J5IGFuZCBsYXVuY2g8Lz5cbiAgICAgICAgICAgIDogPD5TYXZlIGFuZCBjbG9zZTwvPn1cbiAgICAgICAgPC9CdXR0b24+XG4gICAgICA8L2Zvb3Rlcj5cbiAgICA8L2Rpdj5cbiAgKTtcbn07XG4iXX0=